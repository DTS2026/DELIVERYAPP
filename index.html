<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Ventas</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #f4f6f9;
}

header {
  background: linear-gradient(135deg,#0d6efd,#0a58ca);
  color: white;
  padding: 20px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
}

.menu {
  background: white;
  padding: 10px;
  display: flex;
  justify-content: center;
  gap: 15px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

.menu button {
  background: #0d6efd;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 8px;
  cursor: pointer;
}

section {
  padding: 15px;
}

.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(160px,1fr));
  gap: 15px;
}

.card {
  background: white;
  padding: 15px;
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
  text-align: center;
}

.search-box {
  text-align: center;
  margin-bottom: 15px;
}

.search-box input {
  width: 90%;
  max-width: 400px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.resultado {
  background: white;
  margin-bottom: 10px;
  padding: 12px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

canvas {
  background: white;
  padding: 10px;
  border-radius: 12px;
}
</style>
</head>

<body>

<header>
ðŸ“Š Dashboard General de Ventas
</header>

<div class="menu">
  <button onclick="mostrarSeccion('dashboard')">Dashboard</button>
  <button onclick="mostrarSeccion('buscador')">Buscador</button>
</div>

<!-- DASHBOARD -->
<section id="dashboard">

  <h3>Resumen por VehÃ­culo</h3>
  <div id="resumenVehiculos" class="cards"></div>

  <h3 style="margin-top:25px;">Ventas por Unidad de Negocio</h3>
  <canvas id="graficoUnidad"></canvas>

</section>

<!-- BUSCADOR -->
<section id="buscador" style="display:none;">

  <div class="search-box">
    <input type="text" id="busqueda" placeholder="Buscar cliente o producto..." onkeyup="buscar()">
  </div>

  <div id="resultados"></div>

</section>

<script>

// âš ï¸ ESTE ARRAY DEBE SER REEMPLAZADO POR TU JSON REAL
let ventasData = [];

// Cargar JSON externo
fetch('ventas.json')
  .then(res => res.json())
  .then(data => {
    ventasData = data;
    generarResumen();
    generarGrafico();
  })
  .catch(err => {
    console.log("Error cargando JSON", err);
  });

function mostrarSeccion(id){
  document.getElementById("dashboard").style.display = "none";
  document.getElementById("buscador").style.display = "none";
  document.getElementById(id).style.display = "block";
}

function generarResumen() {

  const resumen = {};

  ventasData.forEach(v => {
    const vehiculo = v.vehiculo || "Sin VehÃ­culo";
    const monto = parseFloat(v.monto) || 0;

    if(!resumen[vehiculo]){
      resumen[vehiculo] = 0;
    }

    resumen[vehiculo] += monto;
  });

  const contenedor = document.getElementById("resumenVehiculos");
  contenedor.innerHTML = "";

  for(let vehiculo in resumen){
    contenedor.innerHTML += `
      <div class="card">
        <h4>${vehiculo}</h4>
        <p><strong>S/ ${resumen[vehiculo].toFixed(2)}</strong></p>
      </div>
    `;
  }
}

function generarGrafico() {

  const unidades = {};

  ventasData.forEach(v => {
    const unidad = v.unidad || "Sin Unidad";
    const monto = parseFloat(v.monto) || 0;

    if(!unidades[unidad]){
      unidades[unidad] = 0;
    }

    unidades[unidad] += monto;
  });

  const ctx = document.getElementById('graficoUnidad');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Object.keys(unidades),
      datasets: [{
        label: 'Ventas S/',
        data: Object.values(unidades),
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false }
      }
    }
  });
}

function buscar(){

  const texto = document.getElementById("busqueda").value.toLowerCase();
  const contenedor = document.getElementById("resultados");

  contenedor.innerHTML = "";

  const filtrados = ventasData.filter(v =>
    (v.cliente && v.cliente.toLowerCase().includes(texto)) ||
    (v.producto && v.producto.toLowerCase().includes(texto))
  );

  filtrados.forEach(v => {

    const monto = parseFloat(v.monto) || 0;

    contenedor.innerHTML += `
      <div class="resultado">
        <strong>${v.producto || ''}</strong><br>
        ${v.cliente || ''}<br>
        ${v.cantidad || ''} und<br>
        <strong>S/ ${monto.toFixed(2)}</strong>
      </div>
    `;
  });

}

</script>

</body>
</html>




